jQuery(function(s){"use strict";var p,u,c,m,a,t,d,l,h,_,v,z,g,f,y,w,x,e,r,o,i,n,b,k,j,C,P,I,M,T,Z,S,O,A,B,E,U,D,H,N,R,q,F,G,Q,W,V,$,K;"undefined"!=typeof houzez_map_properties&&(0<s("#houzez-properties-map").length&&(B=houzez_vars.is_mapbox,E=houzez_vars.api_mapbox,u=new Array,new Array,c=1,t=a=0,d="no",m="",l=houzez_vars.admin_url+"admin-ajax.php",h=houzez_vars.user_id,T=houzez_vars.houzez_rtl,_=houzez_vars.processing_text,v=houzez_vars.not_found,z=houzez_vars.compare_url,g=houzez_vars.compare_add_icon,f=houzez_vars.add_compare_text,y=houzez_vars.compare_remove_icon,w=houzez_vars.remove_compare_text,x=houzez_vars.compare_limit,houzez_vars.compare_page_not_found,e=houzez_vars.for_rent_price_slider,r=parseInt(houzez_vars.search_min_price_range),o=parseInt(houzez_vars.search_max_price_range),i=parseInt(houzez_vars.search_min_price_range_for_rent),n=parseInt(houzez_vars.search_max_price_range_for_rent),parseInt(houzez_vars.get_min_price),parseInt(houzez_vars.get_max_price),b=houzez_vars.currency_position,k=houzez_vars.currency_symbol,j=houzez_vars.thousands_separator,C=parseInt(houzez_vars.is_halfmap),P=parseFloat(houzez_vars.default_lat),R=parseFloat(houzez_vars.default_long),I=parseInt(houzez_vars.houzez_default_radius),T="yes"==T,"undefined"!=typeof houzez_map_options&&(c=houzez_map_options.map_cluster_enable,m=houzez_map_options.infoWindowPlac,d=houzez_map_options.markerPricePins),M="mapbox"==B&&""!=E?L.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token="+E,{attribution:'© <a href="https://www.mapbox.com/about/maps/">Mapbox</a> © <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> <strong><a href="https://www.mapbox.com/map-feedback/" target="_blank">Improve this map</a></strong>',tileSize:512,maxZoom:18,zoomOffset:-1,id:"mapbox/streets-v11",accessToken:"YOUR_MAPBOX_ACCESS_TOKEN"}):L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),Z=e=>{if("number"!=typeof e)return e;for(var e=(e+="").split("."),a=e[0],e=1<e.length?"."+e[1]:"",r=/(\d+)(\d{3})/;r.test(a);)a=a.replace(r,"$1"+j+"$2");return a+e},s("#houzez-gmap-next").on("click",function(){!function(e){for(++a>u.length&&(a=1);!1===u[a-1].visible;)++a>u.length&&(a=1);e.getZoom()<15&&e.setZoom(15),e.setView(u[a-1].getLatLng()),u[a-1]._icon||u[a-1].__parent.spiderfy(),e.setZoom(20),a-1==0||a-1==u.length?setTimeout(function(){u[a-1].fire("click")},500):u[a-1].fire("click")}(U)}),s("#houzez-gmap-prev").on("click",function(){!function(e){for(--a<1&&(a=u.length);!1===u[a-1].visible;)--a>u.length&&(a=1);e.getZoom()<15&&e.setZoom(15),e.setView(u[a-1].getLatLng()),u[a-1]._icon||u[a-1].__parent.spiderfy(),e.setZoom(20),a-1==0||a==u.length?setTimeout(function(){u[a-1].fire("click")},500):u[a-1].fire("click")}(U)}),S=function(){for(var e=0;e<u.length;e++)U.removeLayer(u[e]);u=[],p&&U.removeLayer(p)},O=function(e){for(var a=[],r=0;r<e.length;r++)e[r].lat&&e[r].lng&&a.push([e[r].lat,e[r].lng]);return a},A=function(e,a){var r=O(e);1<r.length&&a.fitBounds(r),1==c&&(p=new L.MarkerClusterGroup({iconCreateFunction:function(e){e='<div class="houzez-osm-cluster">'+e.getAllChildMarkers().length+"</div>";return L.divIcon({html:e,className:"mycluster",iconSize:L.point(47,47)})},spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0}));for(var t,o,i,n,s,l=0;l<e.length;l++)e[l].lat&&e[l].lng&&(t=e[l],n=L.latLng(t.lat,t.lng),s={riseOnHover:!0},t.title&&(s.title=t.title),i="yes"==d?(o='<div data-id="'+e[l].property_id+'" class="gm-marker gm-marker-color-'+e[l].term_id+'"><div class="gm-marker-price">'+e[l].pricePin+"</div></div>",o=L.divIcon({className:"someclass",iconSize:new L.Point(0,0),html:o}),1==c?new L.Marker(n,{icon:o}):L.marker(n,{icon:o}).addTo(a)):(t.marker&&(i={iconUrl:t.marker,iconSize:[44,56],iconAnchor:[20,57],popupAnchor:[1,-57]},t.retinaMarker&&(i.iconRetinaUrl=t.retinaMarker),s.icon=L.icon(i)),1==c?new L.Marker(n,s):L.marker(n,s).addTo(a)),1==c&&p.addLayer(i),(n=document.createElement("div")).className="map-info-window",s="",s+='<div class="item-wrap">',s+='<div class="item-header">',e[l].thumbnail?s+='<a href="'+e[l].url+'"><img class="img-fluid" src="'+e[l].thumbnail+'" alt="'+e[l].title+'"/></a>':s+='<a href="'+e[l].url+'"><img class="img-fluid" src="'+m+'" alt="'+e[l].title+'"/></a>',s+="</div>",s+='<div class="item-body flex-grow-1">',s+='<h2 class="item-title">',s+='<a href="'+e[l].url+'">'+e[l].title+"</a>",s+="</h2>",s+='<ul class="list-unstyled item-info">',e[l].price&&(s+='<li class="item-price">'+e[l].price+"</li>"),e[l].property_type&&(s+='<li class="item-type">'+e[l].property_type+"</li>"),s+="</ul>",s+="</div>",s+="</div>",n.innerHTML=s,i.id=t.property_id,u.push(i),i.bindPopup(n));1==c&&a.addLayer(p)},0<houzez_map_properties.length?(B=O(houzez_map_properties),E=L.latLng(P,R),1==B.length&&(E=L.latLng(B[0])),E={dragging:!0,center:E,zoom:10,tap:!1},(U=L.map("houzez-properties-map",E)).scrollWheelZoom.disable(),1<B.length&&U.fitBounds(B),U.addLayer(M),document.getElementById("listing-mapzoomin")&&(K=U,s("#listing-mapzoomin").on("click",function(){var e=parseInt(K.getZoom(),10);console.log(e),20<++e&&(e=20),console.log("=="+e+" ++ "),K.setZoom(e)})),document.getElementById("listing-mapzoomout")&&($=U,s("#listing-mapzoomout").on("click",function(){var e=parseInt($.getZoom(),10);console.log(e),--e<0&&(e=0),console.log("=="+e+" -- "),$.setZoom(e)})),A(houzez_map_properties,U),D=function(e,a){for(var r=a.length,t=0;t<r;t++)if(a[t].id==e)return!0;return!1},H=function(){return s("#half-map-listing-area .item-listing-wrap").each(function(e){var a=s(this).data("hz-id").replace(/[^\d.]/g,"");s(this).on("mouseenter",function(){var r;r=a,U.eachLayer(function(e){var a;void 0!==e._childCount?(a=e.getAllChildMarkers(),D(r,a)&&(e.spiderfy(),a.forEach(function(e){e.id==r&&e.openPopup()}))):e.id==r&&e.openPopup()})}).on("mouseleave",function(){var r;r=a,U.eachLayer(function(a){var e;void 0!==a._childCount?(e=a.getAllChildMarkers(),D(r,e)&&(a.unspiderfy(),e.forEach(function(e){e.id==r&&a.closePopup()}))):a.id==r&&(a.closePopup(),U.closePopup())})})}),!1},(N=!!/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent))||H()):(R={center:[P,R],zoom:10},(U=L.map("houzez-properties-map",R)).addLayer(M),U.scrollWheelZoom.disable()),q=function(e){var r=s("#houzez_ajax_container"),a=s(".map-wrap"),t=s("#half-map-listing-area .page-title span"),o=s(".houzez-search-form-js"),i=s("#ajax_sort_properties").val(),n=s(".listing-view").data("layout");return s.ajax({type:"GET",dataType:"json",url:l,data:o.serialize()+"&action=houzez_half_map_listings&paged="+e+"&sortby="+i+"&item_layout="+n,beforeSend:function(){s(".houzez-map-loading").show(),r.empty().append('<div id="houzez-map-loading" class="houzez-map-loading"><div class="mapPlaceholder"><div class="loader-ripple spinner"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div></div></div>'),a.append('<div id="houzez-map-loading" class="houzez-map-loading"><div class="mapPlaceholder"><div class="loader-ripple spinner"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div></div></div>')},success:function(e){var a;return""!=e.query&&s('input[name="search_args"]').val(e.query),""!=e.search_uri&&s('input[name="search_URI"]').val(e.search_uri),s(".map-notfound").remove(),s(".search-no-results-found").remove(),s(".houzez-map-loading").hide(),!0===e.getProperties?(S(),A(e.properties,U),r.empty().html(e.propHtml),t.empty().html(e.total_results),W(),houzez_init_add_favorite(l,h),houzez_init_remove_favorite(l,h),houzez_listing_lightbox(l,_,T,h),houzez_grid_image_gallery(),houzez_grid_call_to_action(),a=houzezGetCookie("houzez_compare_listings"),add_to_compare(z,g,y,f,w,x,a,4),remove_from_compare(a,g,y,f,w),s('[data-toggle="tooltip"]').tooltip(),N||H()):(S(),s("#houzez-properties-map").append('<div class="map-notfound">'+v+"</div>"),r.empty().html('<div class="search-no-results-found">'+v+"</div>"),t.empty().html(e.total_results)),!1},error:function(e,a,r){console.log(e.status),console.log(e.responseText),console.log(r)}}),!1},F=()=>{var e=s("form.houzez-search-filters-js");if(null==(a=e.attr("action")))return!0;var e=e.find(":input").filter(function(e,a){if(""!=s(a).val()&&"search_geolocation"!=s(a).attr("name")&&"search_URI"!=s(a).attr("name")&&"search_args"!=s(a).attr("name")&&"houzez_save_search_ajax"!=s(a).attr("name"))return!0}).serialize(),a=null==a?"":(a.indexOf("?"),a+"?"+e);a=a,window.history.pushState({houzezTheme:!0},"",a)},G=function(e){S(),s(".hz-halfmap-paged").val(e),F(),q(e)},Q=function(e,a){var r;s(".price-range").slider({range:!0,min:e,max:a,values:[e,a],slide:function(e,a){var r,t;t="after"==b?(r=Z(a.values[0])+k,Z(a.values[1])+k):(r=k+Z(a.values[0]),k+Z(a.values[1])),s(".min-price-range-hidden").val(a.values[0]),s(".max-price-range-hidden").val(a.values[1]),s(".min-price-range").text(r),s(".max-price-range").text(t)},stop:function(e,a){G(t=0)}}),a="after"==b?(r=Z(s(".price-range").slider("values",0))+k,Z(s(".price-range").slider("values",1))+k):(r=k+Z(s(".price-range").slider("values",0)),k+Z(s(".price-range").slider("values",1))),s(".min-price-range").text(r),s(".max-price-range").text(a),s(".min-price-range-hidden").val(s(".price-range").slider("values",0)),s(".max-price-range-hidden").val(s(".price-range").slider("values",1))},0<s(".price-range").length&&1==C&&(s("select.status-js").val()==e?Q(i,n):Q(r,o),s("select.status-js").on("change",function(){s(this).val()==e?Q(i,n):Q(r,o)})),0<s("#radius-range-slider").length&&(V=I,s("#radius-range-slider").slider({value:V,min:0,max:100,step:1,value:s("#radius-range-value").data("default"),slide:function(e,a){s("#radius-range-text").html(a.value),s("#radius-range-value").val(a.value)},stop:function(e,a){0<s("#houzez-properties-map").length&&G(t=0)}}),s("#radius-range-text").html(s("#radius-range-slider").slider("value")),s("#radius-range-value").val(s("#radius-range-slider").slider("value"))),(W=function(){return s(".houzez_ajax_pagination a").on("click",function(e){e.preventDefault(),t=s(this).data("houzepagi"),s(".hz-halfmap-paged").val(t),G(t)}),!1})(),s("#ajax_sort_properties").on("change",function(){G(t=0)}),s("select.houzez_search_ajax, input.houzez_search_ajax").on("change",function(){G(t=0)}),s(".btn-apply, .half-map-search-js-btn, #auto_complete_ajax").on("click",function(e){e.preventDefault(),G(t=0)})),s("#houzez-gmap-full-osm").on("click",function(){var e=s(this);e.hasClass("active")?(e.removeClass("active"),e.parents(".map-wrap").removeClass("houzez-fullscreen-map")):(e.parents(".map-wrap").addClass("houzez-fullscreen-map"),e.addClass("active")),U.invalidateSize(),U.panTo(U.getCenter())}),s("#houzez-btn-map-view").on("click",function(e){e.preventDefault(),s("#half-map-listing-area, .listing-wrap").hide(),s("#map-view-wrap").show(),U.invalidateSize(),U.panTo(U.getCenter());e=O(houzez_map_properties);1<e.length&&U.fitBounds(e)}),s("#houzez-btn-listing-view").on("click",function(e){e.preventDefault(),s("#map-view-wrap").hide(),s("#half-map-listing-area, .listing-wrap").show()}),0<s("input.search_location_js").length&&jQuery("input.search_location_js").autocomplete({source:function(e,a){jQuery.get("https://nominatim.openstreetmap.org/search",{format:"json",q:e.term},function(e){e.length?a(e.map(function(e){return{label:e.display_name,latitude:e.lat,longitude:e.lon,value:e.display_name}})):a([{value:"",label:"there are no results"}])},"json")},select:function(e,a){s('input[name="lat"]').val(a.item.latitude),s('input[name="lng"]').val(a.item.longitude),C&&G(0)}}))});